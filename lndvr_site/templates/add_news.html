{% extends 'base.html' %}
{% load static %}

{% block head %}
  <link rel="stylesheet" href="{% static 'CSS/add_news.css' %}">
{% endblock head %}

{% block title %} Add News | {% endblock title %}

{% block body %}
<div class="heading-container">
  <h1>Add Financial News</h1>
</div>
<div class="addnews-container">

  <form method="POST" enctype="multipart/form-data" class="news-form">
    {% csrf_token %}

    <div class="form-group">
      <label for="title">News Title<span style="color: red;">*</span></label>
      <input type="text" id="title" name="title" required maxlength="250">
    </div>

    <div class="form-group">
      <label for="date_publish">Publish Date<span style="color: red;">*</span></label>
      <input type="date" id="date_publish" name="date_publish" required>
    </div>

    <div class="form-group">
      <label for="content">Content<span style="color: red;">*</span></label>
      <textarea id="content" name="content" required></textarea>
    </div>

    <div class="form-group">
      <label for="summary">Summary</label>
      <textarea id="summary" name="summary" rows="8"></textarea>
    </div>

    <div class="form-group">
      <label for="added_by">Added By<span style="color: red;">*</span></label>
      <input type="email" id="added_by" name="added_by" value="{{ user_email }}" readonly>
    </div>

    {% comment %} <div class="form-group">
      <label for="thumbnail">Thumbnail Image</label>
      <input type="file" id="thumbnail" name="thumbnail" accept="image/*">
    </div> {% endcomment %}

    <div class="form-group">
      <label for="thumbnail">Thumbnail Image</label>

      <div class="thumbnail-preview" id="newThumbnailPreview" style="display: none;">
        <img id="previewImage" alt="Preview Thumbnail" style="max-width: 200px; height: auto; border-radius: 8px;">
        <button type="button" class="delete-thumbnail-btn" onclick="clearNewThumbnail()">âœ–</button>
      </div>

      <input type="file" id="thumbnail" name="thumbnail" accept="image/*">
    </div>

    <div class="form-group checkbox">
      <label><input type="checkbox" name="active" checked> Active <span style="color: red;">*</span></label>
    </div>

    <div class="form-group">
      <button type="submit" class="btn btn-success">Submit</button>
    </div>
  </form>
</div>

<script>
  // Get references to input and preview elements
  const fileInput = document.getElementById('thumbnail');            // File input field
  const previewWrapper = document.getElementById('newThumbnailPreview'); // Div wrapping preview image and delete button
  const previewImage = document.getElementById('previewImage');      // The image element to show thumbnail

  // Handle file selection and show preview
  fileInput.addEventListener('change', () => {
    const file = fileInput.files[0];  // Get the selected file
    if (file) {
      // Generate and show preview using object URL
      previewImage.src = URL.createObjectURL(file);
      previewWrapper.style.display = 'block';
    }
  });

  // Function to clear preview and reset file input
  function clearNewThumbnail() {
    fileInput.value = '';                // Reset file input
    previewImage.src = '';               // Clear preview image
    previewWrapper.style.display = 'none'; // Hide preview container
  }
</script>


{% endblock body %}
